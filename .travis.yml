language: go

go:
  - 1.5
  - tip

before_install:
  - go get github.com/golang/glog
  - go get golang.org/x/net/proxy
  - go get github.com/spf13/viper
  - go get github.com/armon/go-socks5

before_deploy:
  - make buildarch

deploy:
  provider: releases
  api_key: $CI_USER_TOKEN
  skip_cleanup: true
  file:
    - zoneproxy-linux-arm.zip
    - zoneproxy-linux-386.zip
    - zoneproxy-linux-amd64.zip
    - zoneproxy-freebsd-arm.zip
    - zoneproxy-freebsd-386.zip
    - zoneproxy-freebsd-amd64.zip
    - zoneproxy-darwin-arm.zip
    - zoneproxy-darwin-386.zip
    - zoneproxy-darwin-amd64.zip
  on:
    tags: true
    all_branches: true
    go: 1.5